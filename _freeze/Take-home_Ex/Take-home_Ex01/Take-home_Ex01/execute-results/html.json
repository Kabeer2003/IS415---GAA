{
  "hash": "652bba5feac976fc7514cd505251a8b4",
  "result": {
    "markdown": "---\ntitle: \"Take-home_Ex01\"\nauthor: Kabeer\ndate: \"February 22, 2024\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  warning: false\n  freeze: true\n---\n\n\nInstalling relevant R packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|eval: False\ninstall.packages(\"spatstat\", dependencies = TRUE, repos = \"https://cran.rstudio.com/\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npackage 'spatstat' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n\tC:\\Users\\91770\\AppData\\Local\\Temp\\Rtmp4g2hDO\\downloaded_packages\n```\n:::\n\n```{.r .cell-code}\ninstall.packages(\"maptools\", repos = \"https://packagemanager.posit.co/cran/2023-10-13\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npackage 'maptools' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n\tC:\\Users\\91770\\AppData\\Local\\Temp\\Rtmp4g2hDO\\downloaded_packages\n```\n:::\n\n```{.r .cell-code}\npacman::p_load(arrow, classInt, ggplot2, lubridate, maptools, raster, sf, spatstat, sp, spNetwork, tidyverse, tmap, viridis)\n```\n:::\n\n\nImporting Geopatial Data\n\na)  Importing the map of Singapore with subzone boundaries (as of 2019)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_sf <- st_read(\"data/geospatial/MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `MasterPlan2019SubzoneBoundaryNoSeaGEOJSON' from data source \n  `D:\\Kabeer2003\\IS415 - GAA\\Take-home_Ex\\Take-home_Ex01\\data\\geospatial\\MasterPlan2019SubzoneBoundaryNoSeaGEOJSON.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nmap_sf <- st_zm(map_sf, drop = TRUE)\nmap_sf <- st_transform(map_sf, crs = 4326)\nmap_sf <- st_make_valid(map_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_sf <- st_make_valid(map_sf)\n```\n:::\n\n\nb)  Roads for Singapore\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroads_sf <- st_read(\"data/geospatial/singapore_roads.gpkg\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `Singapore_roads' from data source \n  `D:\\Kabeer2003\\IS415 - GAA\\Take-home_Ex\\Take-home_Ex01\\data\\geospatial\\Singapore_roads.gpkg' \n  using driver `GPKG'\nSimple feature collection with 258128 features and 10 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 103.5283 ymin: 1.212521 xmax: 104.1104 ymax: 1.508495\nGeodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nroads_sf <- st_transform(roads_sf, crs = 4326)\n\nroads_sf <- roads_sf %>% filter(fclass %in% c(\"primary\", \"secondary\", \"tertiary\", \"motorway\", \"trunk\"), !is.na(name))\n```\n:::\n\n\nImporting Aspatial Data\n\na)  (GrabPosisi): Includes timestamps and destination points for each trip\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrabdata <- read_rds(\"data/aspatial/rds/destination_df.rds\")\n```\n:::\n\n\nExtracting all destination points and to ensure that the pt is a destination pt, we take the last point for every trj_id in addition to which we ensure that the car is stationary (Speed \\< 0.1 km/h)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrips_by_destination_pts <- grabdata %>%\n  group_by(trj_id) %>%\n  slice(n()) %>%\n  filter(speed <= 0.25 && speed >= -0.25) %>%  \n  select(trj_id, latitude = rawlat, longitude = rawlng, speed, pingtimestamp, weekday)\n```\n:::\n\n\nConverting all extracted destination points to an sf dataframe so that they could be plotted on a map\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrips_by_destination_pts <- st_as_sf(trips_by_destination_pts, coords = c(\"longitude\", \"latitude\"), crs = 4326)\n```\n:::\n\n\nTo plot the kernel density of destination pts on a map, we need to create a ppp object of all destination points which is binded to the map of Singapore.\n\nSince ppp and owin objects cannot be created in degrees i.e. WGS84, we would have to use a two-dimensional CRS that uses relative distances from a reference point eg. SVY21. Hence we would be converting the coordinate reference system of both our dataframe with all points and the map of Singapore to SVY21.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_sf <- st_transform(map_sf, 3414)\nmap_sf <- st_make_valid(map_sf)\n\ntrips_by_destination_pts <- st_transform(trips_by_destination_pts, 3414)\ntrips_by_destination_pts <- st_make_valid(trips_by_destination_pts)\n```\n:::\n\n\nTo create a binded ppp object, the owin and ppp objects can only be created from spatial objects (SP). Hence, we shall convert both the aspatial and geospatial data to a generic sp format first\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrips_by_destination_pts <- as_Spatial(trips_by_destination_pts) \nmap <- as_Spatial(map_sf)\n\ntrips_by_destination_pts <- as(trips_by_destination_pts, \"SpatialPoints\") \nmap <- as(map, \"SpatialPolygons\")\n```\n:::\n\n\nConverting the sp map object to an owin object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgmap_owin <- as.owin(map)\n\nplot(sgmap_owin)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(sgmap_owin)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWindow: polygonal boundary\n394 separate polygons (19 holes)\n                   vertices         area relative.area\npolygon 1                85  4.42296e+05      5.64e-04\npolygon 2                38  4.11723e+05      5.25e-04\npolygon 3               227  5.87221e+05      7.48e-04\npolygon 4                35  3.94370e+04      5.03e-05\npolygon 5                96  1.88768e+05      2.41e-04\npolygon 6                59  1.33007e+05      1.69e-04\npolygon 7                46  4.48128e+05      5.71e-04\npolygon 8                31  5.21199e+05      6.64e-04\npolygon 9                17  3.50788e+05      4.47e-04\npolygon 10               54  2.61841e+05      3.34e-04\npolygon 11              152  1.63038e+06      2.08e-03\npolygon 12              273  6.14923e+05      7.84e-04\npolygon 13              299  1.84404e+06      2.35e-03\npolygon 14              164  3.92563e+05      5.00e-04\npolygon 15              238  5.06591e+05      6.46e-04\npolygon 16               22  6.74620e+03      8.60e-06\npolygon 17               47  3.82089e+04      4.87e-05\npolygon 18               65  8.42861e+04      1.07e-04\npolygon 19              483  2.06117e+06      2.63e-03\npolygon 20              264  1.50631e+06      1.92e-03\npolygon 21             1263  3.29427e+07      4.20e-02\npolygon 22 (hole)         3 -4.25791e-02     -5.43e-11\npolygon 23              132  3.88733e+05      4.95e-04\npolygon 24              180  5.61608e+05      7.16e-04\npolygon 25               47  1.60809e+05      2.05e-04\npolygon 26               49  5.95241e+05      7.58e-04\npolygon 27               49  3.87611e+05      4.94e-04\npolygon 28               59  1.03038e+06      1.31e-03\npolygon 29               83  5.51731e+05      7.03e-04\npolygon 30               69  2.90185e+05      3.70e-04\npolygon 31              217  1.08479e+06      1.38e-03\npolygon 32               41  6.28892e+05      8.01e-04\npolygon 33              255  1.59034e+06      2.03e-03\npolygon 34                4  9.47128e+01      1.21e-07\npolygon 35               37  1.29491e+04      1.65e-05\npolygon 36               30  4.28953e+03      5.47e-06\npolygon 37              145  9.61783e+05      1.23e-03\npolygon 38              227  1.10308e+06      1.41e-03\npolygon 39               19  3.09219e+04      3.94e-05\npolygon 40               10  6.60201e+03      8.41e-06\npolygon 41              234  2.08755e+06      2.66e-03\npolygon 42               15  4.03288e+04      5.14e-05\npolygon 43             1045  4.44510e+06      5.66e-03\npolygon 44 (hole)        13 -3.92141e+02     -5.00e-07\npolygon 45              232  4.72887e+05      6.03e-04\npolygon 46               14  5.86528e+03      7.47e-06\npolygon 47               10  4.90997e+02      6.26e-07\npolygon 48               94  5.96175e+04      7.60e-05\npolygon 49               59  3.43163e+04      4.37e-05\npolygon 50                4  2.69408e+02      3.43e-07\npolygon 51             1020  1.27781e+06      1.63e-03\npolygon 52 (hole)         3 -1.06327e-01     -1.35e-10\npolygon 53 (hole)         4 -1.23063e-04     -1.57e-13\npolygon 54 (hole)         4 -7.56223e-02     -9.64e-11\npolygon 55 (hole)         4 -3.94356e-01     -5.03e-10\npolygon 56 (hole)         4 -7.19058e-01     -9.16e-10\npolygon 57              129  9.53762e+04      1.22e-04\npolygon 58                6  4.50376e+02      5.74e-07\npolygon 59              155  2.67503e+05      3.41e-04\npolygon 60              211  4.70522e+05      6.00e-04\npolygon 61              106  3.04131e+03      3.88e-06\npolygon 62               83  5.28926e+03      6.74e-06\npolygon 63             1424  4.87153e+06      6.21e-03\npolygon 64 (hole)         3 -2.73199e-02     -3.48e-11\npolygon 65 (hole)         4 -2.46124e-04     -3.14e-13\npolygon 66 (hole)         3 -3.69186e-03     -4.70e-12\npolygon 67 (hole)        11 -8.36614e+01     -1.07e-07\npolygon 68               75  1.73525e+04      2.21e-05\npolygon 69              147  3.10396e+03      3.96e-06\npolygon 70              137  3.22285e+03      4.11e-06\npolygon 71               45  2.51228e+03      3.20e-06\npolygon 72               40  1.38603e+04      1.77e-05\npolygon 73              438  3.45157e+06      4.40e-03\npolygon 74               83  1.03237e+05      1.32e-04\npolygon 75              102  1.12730e+06      1.44e-03\npolygon 76              828  2.70003e+06      3.44e-03\npolygon 77 (hole)        23 -1.99689e+01     -2.54e-08\npolygon 78 (hole)        35 -1.38430e+02     -1.76e-07\npolygon 79 (hole)        19 -4.37731e+00     -5.58e-09\npolygon 80 (hole)       270 -1.21366e+03     -1.55e-06\npolygon 81               88  5.33462e+05      6.80e-04\npolygon 82               95  1.45518e+05      1.85e-04\npolygon 83               55  6.35706e+05      8.10e-04\npolygon 84               53  2.76828e+05      3.53e-04\npolygon 85              114  6.36655e+04      8.11e-05\npolygon 86               83  1.96620e+05      2.51e-04\npolygon 87               33  3.65334e+05      4.66e-04\npolygon 88              110  1.45503e+06      1.85e-03\npolygon 89              135  8.53202e+05      1.09e-03\npolygon 90              196  1.07072e+06      1.36e-03\npolygon 91               47  5.33012e+05      6.79e-04\npolygon 92              130  2.80176e+05      3.57e-04\npolygon 93              140  2.14251e+05      2.73e-04\npolygon 94               83  1.73123e+05      2.21e-04\npolygon 95              192  5.91779e+05      7.54e-04\npolygon 96              174  1.75348e+06      2.23e-03\npolygon 97              192  3.40742e+05      4.34e-04\npolygon 98               58  3.10535e+05      3.96e-04\npolygon 99              114  1.38034e+06      1.76e-03\npolygon 100             134  1.95176e+06      2.49e-03\npolygon 101             270  4.51538e+05      5.75e-04\npolygon 102              80  6.97507e+05      8.89e-04\npolygon 103             122  1.72655e+05      2.20e-04\npolygon 104             271  1.09784e+06      1.40e-03\npolygon 105             137  1.05800e+06      1.35e-03\npolygon 106             313  2.79680e+06      3.56e-03\npolygon 107             495  3.05099e+06      3.89e-03\npolygon 108             137  3.36218e+05      4.28e-04\npolygon 109              62  7.42203e+05      9.46e-04\npolygon 110             226  1.82685e+06      2.33e-03\npolygon 111              55  2.93699e+05      3.74e-04\npolygon 112             247  5.57280e+05      7.10e-04\npolygon 113              48  5.56817e+04      7.10e-05\npolygon 114              60  1.16331e+05      1.48e-04\npolygon 115             343  2.00345e+06      2.55e-03\npolygon 116             129  2.43459e+06      3.10e-03\npolygon 117             114  1.07899e+06      1.37e-03\npolygon 118             319  4.60551e+05      5.87e-04\npolygon 119             198  5.43484e+05      6.93e-04\npolygon 120              51  2.78303e+05      3.55e-04\npolygon 121             690  1.77060e+06      2.26e-03\npolygon 122             297  8.86957e+05      1.13e-03\npolygon 123             182  2.18809e+05      2.79e-04\npolygon 124             217  3.29438e+05      4.20e-04\npolygon 125              87  1.70664e+05      2.17e-04\npolygon 126             217  1.34616e+06      1.72e-03\npolygon 127              27  1.71336e+05      2.18e-04\npolygon 128              84  4.96255e+04      6.32e-05\npolygon 129             198  1.93991e+05      2.47e-04\npolygon 130              77  1.20171e+05      1.53e-04\npolygon 131             108  1.02656e+06      1.31e-03\npolygon 132             129  2.00787e+05      2.56e-04\npolygon 133             169  7.10568e+05      9.05e-04\npolygon 134              34  7.48683e+05      9.54e-04\npolygon 135             173  3.68483e+05      4.70e-04\npolygon 136             294  7.60622e+06      9.69e-03\npolygon 137             238  2.21999e+05      2.83e-04\npolygon 138              75  1.26341e+06      1.61e-03\npolygon 139              50  3.69771e+05      4.71e-04\npolygon 140              83  3.20366e+06      4.08e-03\npolygon 141              96  1.10727e+06      1.41e-03\npolygon 142              43  5.54625e+05      7.07e-04\npolygon 143             126  3.38725e+06      4.32e-03\npolygon 144              94  1.87800e+06      2.39e-03\npolygon 145              40  8.67749e+05      1.11e-03\npolygon 146              55  6.39144e+05      8.14e-04\npolygon 147              39  3.26015e+06      4.15e-03\npolygon 148              54  4.11402e+05      5.24e-04\npolygon 149              75  4.18656e+05      5.33e-04\npolygon 150             104  2.09818e+06      2.67e-03\npolygon 151              91  1.52455e+06      1.94e-03\npolygon 152              74  2.18107e+05      2.78e-04\npolygon 153             104  2.13519e+05      2.72e-04\npolygon 154             209  2.47265e+06      3.15e-03\npolygon 155 (hole)        3 -4.87319e-02     -6.21e-11\npolygon 156 (hole)        3 -3.81487e-03     -4.86e-12\npolygon 157 (hole)       38 -7.79903e+03     -9.94e-06\npolygon 158               4  1.46442e-02      1.87e-11\npolygon 159              58  3.16883e+05      4.04e-04\npolygon 160              94  1.04642e+06      1.33e-03\npolygon 161              63  9.21433e+05      1.17e-03\npolygon 162              57  2.39334e+06      3.05e-03\npolygon 163             605  1.94141e+06      2.47e-03\npolygon 164             324  2.12118e+06      2.70e-03\npolygon 165             119  4.85574e+05      6.19e-04\npolygon 166             102  7.56923e+05      9.64e-04\npolygon 167             111  4.29714e+06      5.48e-03\npolygon 168             110  9.91059e+05      1.26e-03\npolygon 169             381  2.03851e+06      2.60e-03\npolygon 170             125  2.57843e+06      3.29e-03\npolygon 171              91  3.18758e+06      4.06e-03\npolygon 172              35  2.56100e+06      3.26e-03\npolygon 173             112  7.35502e+05      9.37e-04\npolygon 174             117  3.51306e+05      4.48e-04\npolygon 175              69  1.31292e+06      1.67e-03\npolygon 176              67  9.47451e+05      1.21e-03\npolygon 177             100  7.49195e+05      9.55e-04\npolygon 178              93  1.05203e+06      1.34e-03\npolygon 179              92  4.10940e+05      5.24e-04\npolygon 180              72  8.39679e+05      1.07e-03\npolygon 181             184  1.22706e+06      1.56e-03\npolygon 182             120  5.58761e+05      7.12e-04\npolygon 183             212  2.09608e+06      2.67e-03\npolygon 184              88  7.22591e+05      9.21e-04\npolygon 185             281  2.55046e+06      3.25e-03\npolygon 186              34  2.04263e+06      2.60e-03\npolygon 187              70  3.26041e+06      4.15e-03\npolygon 188             119  2.15829e+06      2.75e-03\npolygon 189             140  1.34746e+06      1.72e-03\npolygon 190              60  2.33891e+06      2.98e-03\npolygon 191             154  1.67538e+05      2.13e-04\npolygon 192              81  1.16002e+06      1.48e-03\npolygon 193              92  2.34937e+06      2.99e-03\npolygon 194              86  9.63497e+05      1.23e-03\npolygon 195              35  4.85023e+05      6.18e-04\npolygon 196              82  1.88130e+06      2.40e-03\npolygon 197             103  1.42508e+06      1.82e-03\npolygon 198              60  2.38727e+06      3.04e-03\npolygon 199              74  1.22990e+06      1.57e-03\npolygon 200             123  9.63924e+05      1.23e-03\npolygon 201             182  2.77329e+06      3.53e-03\npolygon 202             131  3.46851e+06      4.42e-03\npolygon 203             452  7.65582e+06      9.76e-03\npolygon 204             124  9.48159e+05      1.21e-03\npolygon 205             132  1.31911e+06      1.68e-03\npolygon 206              60  2.99730e+06      3.82e-03\npolygon 207             236  1.97413e+06      2.52e-03\npolygon 208              91  1.49663e+04      1.91e-05\npolygon 209              71  8.18741e+03      1.04e-05\npolygon 210             132  1.77074e+06      2.26e-03\npolygon 211             210  1.78726e+05      2.28e-04\npolygon 212              84  2.25923e+06      2.88e-03\npolygon 213              58  8.59179e+05      1.09e-03\npolygon 214              71  1.94861e+06      2.48e-03\npolygon 215              87  1.07862e+06      1.37e-03\npolygon 216             151  3.02315e+06      3.85e-03\npolygon 217              35  4.41738e+05      5.63e-04\npolygon 218              60  9.72126e+05      1.24e-03\npolygon 219              94  1.23590e+06      1.57e-03\npolygon 220             101  1.63984e+06      2.09e-03\npolygon 221             106  2.54311e+06      3.24e-03\npolygon 222              83  9.55710e+05      1.22e-03\npolygon 223             165  8.94517e+05      1.14e-03\npolygon 224              76  9.11208e+05      1.16e-03\npolygon 225              43  1.14382e+06      1.46e-03\npolygon 226             122  1.37683e+06      1.75e-03\npolygon 227             129  1.92662e+06      2.45e-03\npolygon 228             373  4.13716e+06      5.27e-03\npolygon 229              79  1.06189e+06      1.35e-03\npolygon 230              74  1.79446e+06      2.29e-03\npolygon 231             101  3.47525e+06      4.43e-03\npolygon 232              94  1.23166e+06      1.57e-03\npolygon 233              52  6.84703e+05      8.72e-04\npolygon 234             159  1.08508e+06      1.38e-03\npolygon 235              44  1.97494e+06      2.52e-03\npolygon 236             141  4.14132e+06      5.28e-03\npolygon 237             159  4.34376e+06      5.53e-03\npolygon 238              59  1.51553e+06      1.93e-03\npolygon 239              60  9.44998e+05      1.20e-03\npolygon 240             191  1.99363e+06      2.54e-03\npolygon 241             113  2.07797e+06      2.65e-03\npolygon 242             136  3.14493e+06      4.01e-03\npolygon 243             195  2.63648e+06      3.36e-03\npolygon 244              80  1.05717e+06      1.35e-03\npolygon 245              56  1.28795e+06      1.64e-03\npolygon 246              69  4.39648e+05      5.60e-04\npolygon 247              50  7.46884e+05      9.52e-04\npolygon 248             108  2.77749e+06      3.54e-03\npolygon 249              40  9.06316e+05      1.15e-03\npolygon 250              41  3.80204e+05      4.84e-04\npolygon 251              82  5.27471e+05      6.72e-04\npolygon 252              77  8.00299e+05      1.02e-03\npolygon 253             147  8.98557e+05      1.14e-03\npolygon 254             154  1.79616e+06      2.29e-03\npolygon 255             130  2.25124e+06      2.87e-03\npolygon 256             125  7.76141e+05      9.89e-04\npolygon 257              61  4.46241e+05      5.69e-04\npolygon 258              72  5.72500e+05      7.30e-04\npolygon 259              79  8.13382e+05      1.04e-03\npolygon 260              94  1.48429e+06      1.89e-03\npolygon 261             341  1.97707e+06      2.52e-03\npolygon 262              97  1.03728e+06      1.32e-03\npolygon 263             167  2.82095e+06      3.59e-03\npolygon 264              56  9.24760e+05      1.18e-03\npolygon 265             119  1.80638e+06      2.30e-03\npolygon 266              64  1.40454e+06      1.79e-03\npolygon 267              91  2.37934e+06      3.03e-03\npolygon 268             316  8.50229e+06      1.08e-02\npolygon 269 (hole)      316 -5.11288e+04     -6.52e-05\npolygon 270             365  1.37341e+06      1.75e-03\npolygon 271              67  1.43137e+05      1.82e-04\npolygon 272              64  4.36369e+05      5.56e-04\npolygon 273             126  1.51148e+06      1.93e-03\npolygon 274             152  2.45626e+06      3.13e-03\npolygon 275              80  1.28721e+06      1.64e-03\npolygon 276              32  8.42672e+05      1.07e-03\npolygon 277              61  1.33353e+06      1.70e-03\npolygon 278              50  1.00740e+06      1.28e-03\npolygon 279             234  4.80392e+06      6.12e-03\npolygon 280             244  4.70674e+05      6.00e-04\npolygon 281              95  1.32887e+06      1.69e-03\npolygon 282             114  6.01728e+05      7.67e-04\npolygon 283              66  7.63181e+05      9.72e-04\npolygon 284              68  9.24865e+05      1.18e-03\npolygon 285              55  8.62737e+05      1.10e-03\npolygon 286             105  1.58344e+06      2.02e-03\npolygon 287              43  8.46135e+05      1.08e-03\npolygon 288             256  9.97938e+05      1.27e-03\npolygon 289              59  1.46053e+06      1.86e-03\npolygon 290              47  1.49669e+06      1.91e-03\npolygon 291             153  1.66708e+06      2.12e-03\npolygon 292              81  2.39163e+06      3.05e-03\npolygon 293              52  1.37871e+06      1.76e-03\npolygon 294             100  9.23214e+05      1.18e-03\npolygon 295             246  5.32542e+06      6.79e-03\npolygon 296             122  1.74439e+06      2.22e-03\npolygon 297              76  1.00320e+06      1.28e-03\npolygon 298              68  1.09569e+06      1.40e-03\npolygon 299              53  6.68456e+05      8.52e-04\npolygon 300              69  6.24879e+05      7.96e-04\npolygon 301              85  6.74995e+05      8.60e-04\npolygon 302             123  2.33068e+06      2.97e-03\npolygon 303              68  1.09322e+06      1.39e-03\npolygon 304              83  1.86187e+06      2.37e-03\npolygon 305              45  9.09420e+05      1.16e-03\npolygon 306             102  2.10617e+06      2.68e-03\npolygon 307             204  3.33419e+06      4.25e-03\npolygon 308             285  1.71971e+06      2.19e-03\npolygon 309              85  1.08864e+06      1.39e-03\npolygon 310              81  1.56904e+06      2.00e-03\npolygon 311              83  1.46451e+06      1.87e-03\npolygon 312             105  2.20631e+06      2.81e-03\npolygon 313             106  1.18013e+06      1.50e-03\npolygon 314             174  1.79346e+06      2.29e-03\npolygon 315             112  3.91607e+06      4.99e-03\npolygon 316             148  2.17538e+06      2.77e-03\npolygon 317             141  3.62301e+06      4.62e-03\npolygon 318              80  1.43291e+06      1.83e-03\npolygon 319             114  4.38841e+06      5.59e-03\npolygon 320             162  1.20044e+06      1.53e-03\npolygon 321             128  1.34017e+06      1.71e-03\npolygon 322             263  3.28413e+06      4.18e-03\npolygon 323             118  2.55346e+06      3.25e-03\npolygon 324              48  9.61420e+05      1.23e-03\npolygon 325             112  1.28130e+06      1.63e-03\npolygon 326              26  7.58119e+05      9.66e-04\npolygon 327              76  9.05921e+05      1.15e-03\npolygon 328             100  1.41803e+06      1.81e-03\npolygon 329              50  1.48925e+06      1.90e-03\npolygon 330             117  5.18612e+06      6.61e-03\npolygon 331              71  2.35998e+05      3.01e-04\npolygon 332             265  5.86424e+06      7.47e-03\npolygon 333             103  4.47202e+06      5.70e-03\npolygon 334              75  5.00144e+05      6.37e-04\npolygon 335              85  6.97635e+05      8.89e-04\npolygon 336             305  1.13095e+06      1.44e-03\npolygon 337              86  1.45916e+06      1.86e-03\npolygon 338              42  7.84707e+05      1.00e-03\npolygon 339              68  1.04642e+06      1.33e-03\npolygon 340              59  8.99104e+05      1.15e-03\npolygon 341              28  7.80760e+05      9.95e-04\npolygon 342             321  4.82856e+05      6.15e-04\npolygon 343             535  2.45095e+06      3.12e-03\npolygon 344              77  2.20921e+06      2.82e-03\npolygon 345              79  1.26204e+06      1.61e-03\npolygon 346              40  1.25240e+06      1.60e-03\npolygon 347             779  3.71587e+07      4.73e-02\npolygon 348             125  1.54074e+06      1.96e-03\npolygon 349             378  1.63581e+06      2.08e-03\npolygon 350             361  2.24122e+06      2.86e-03\npolygon 351             667  3.56692e+07      4.55e-02\npolygon 352              97  9.13532e+04      1.16e-04\npolygon 353             128  1.71195e+06      2.18e-03\npolygon 354             163  2.96147e+06      3.77e-03\npolygon 355               3  6.54649e-01      8.34e-10\npolygon 356             129  1.25974e+06      1.61e-03\npolygon 357             112  3.29141e+06      4.19e-03\npolygon 358             102  1.57600e+06      2.01e-03\npolygon 359             124  1.66419e+06      2.12e-03\npolygon 360              94  1.76924e+06      2.25e-03\npolygon 361            1951  6.85075e+07      8.73e-02\npolygon 362              30  2.80002e+04      3.57e-05\npolygon 363              27  1.50311e+04      1.92e-05\npolygon 364             103  2.05005e+06      2.61e-03\npolygon 365             285  1.61128e+06      2.05e-03\npolygon 366              65  1.26165e+06      1.61e-03\npolygon 367            1631  1.74954e+07      2.23e-02\npolygon 368             164  3.45046e+06      4.40e-03\npolygon 369              65  1.74336e+06      2.22e-03\npolygon 370              73  1.39448e+06      1.78e-03\npolygon 371             141  1.07438e+06      1.37e-03\npolygon 372             129  1.51776e+06      1.93e-03\npolygon 373             117  5.95652e+05      7.59e-04\npolygon 374             719  5.40368e+07      6.89e-02\npolygon 375              77  3.29940e+05      4.20e-04\npolygon 376             708  1.28815e+07      1.64e-02\npolygon 377              44  2.26583e+03      2.89e-06\npolygon 378             192  2.14709e+06      2.74e-03\npolygon 379              90  1.51100e+06      1.93e-03\npolygon 380             125  9.36415e+05      1.19e-03\npolygon 381             148  1.64863e+06      2.10e-03\npolygon 382             102  1.09939e+06      1.40e-03\npolygon 383             158  3.65203e+06      4.65e-03\npolygon 384             373  7.05426e+06      8.99e-03\npolygon 385             209  7.23576e+06      9.22e-03\npolygon 386             103  2.20675e+06      2.81e-03\npolygon 387             268  3.84951e+06      4.91e-03\npolygon 388             102  6.87914e+05      8.77e-04\npolygon 389              74  5.46394e+05      6.96e-04\npolygon 390             102  1.96415e+06      2.50e-03\npolygon 391              71  5.63055e+03      7.17e-06\npolygon 392              10  1.99759e+02      2.55e-07\npolygon 393             731  2.77044e+07      3.53e-02\npolygon 394               3  1.96470e-01      2.50e-10\nenclosing rectangle: [2667.54, 56396.44] x [15748.72, 50256.33] units\n                     (53730 x 34510 units)\nWindow area = 784784000 square units\nFraction of frame area: 0.423\n```\n:::\n:::\n\n\nConverting aspatial data (the trips by destination points) to the ppp format (which would be used for kernel density eventually)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrips_by_destination_ppp <- as(trips_by_destination_pts, \"ppp\")\nplot(trips_by_destination_ppp)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(trips_by_destination_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPlanar point pattern:  1843 points\nAverage intensity 2.112541e-06 points per square unit\n\nCoordinates are given to 3 decimal places\ni.e. rounded to the nearest multiple of 0.001 units\n\nWindow: rectangle = [5415.33, 45299.62] x [27598.6, 49472.1] units\n                    (39880 x 21870 units)\nWindow area = 872409000 square units\n```\n:::\n:::\n\n\nBefore binding the ppp object to the owin object, its crucial to eliminate any redundancies (Duplicated pts)\n\nEliminating redundancies via Jittering (None removed as no redundancies exist in this dataset)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(trips_by_destination_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\ntrips_by_destination_ppp <- rjitter(trips_by_destination_ppp, retry = TRUE, nsim = 1, drop = TRUE)\nany(duplicated(trips_by_destination_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nNext, we would bind the Bind ppp data structure to the owin map object (Overlay the ppp dataframe on the map of Singapore ensuring all pts are in range)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrips_by_destination_ppp = trips_by_destination_ppp[sgmap_owin]\nplot(trips_by_destination_ppp)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nUpon conducting a visual inspection on the map, it is imperative that the CBD is a popular destination for grab passengers indicating that most passengers use Grab to travel to their workplaces / offices in time.\n\nAnother popular destination is the north of Singapore around woodlands checkpoint which indicates that a lot of passengers also hitch a ride to woodlands checkpoint to avoid longer queues at immigration.\n\nThe same would later be emperically proven using kernel density\n\nBefore plotting Kernel Density, we would conver the unit from meters to km and rescale everything such that all distances would be divided by 1000.\n\nConverting the unit of scale to kilometers\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrips_by_destination_ppp <- rescale(trips_by_destination_ppp, 1000, \"km\")\n```\n:::\n\n\nMap depicting Kernel density of destination pts across Singapore.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_destination_pts_bw <- density(trips_by_destination_ppp, sigma=0.75, edge=TRUE, kernel=\"gaussian\")\nplot(kde_destination_pts_bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nBased on the kernel density plot, it could be inferred that more passengers alight either in the central area around the CBD / CBD fringe areas comprising primarily of people working in corporate jobs who wish to get to work in time.\n\nIn addition, an almost equal sizable amount of passengers alight in the north around woodlands (Mostly around the checkpoint) which could be individuals seeking to avoid longer immigration queues heading to Johor and other parts of Malaysia.\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}