<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kabeer">
<meta name="dcterms.date" content="2024-03-23">

<title>IS415 - GAA - Take_home_Ex03 test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">IS415 - GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="./Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="./In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./In-class_Ex/In-class_Ex03/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./In-class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-Home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="./Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take_home_Ex03 test</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kabeer </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 23, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: False</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sp, spdep, sfdep, tmap, tidyverse, knitr, tibble, dplyr, lubridate, spacetime, stars, plotly, stringr, spatstat, maptools, raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"D:/Kabeer2003/GAA Project Group 5/GAA-Project-2024-Group-5-/data/geospatial/MP14_SUBZONE_WEB_PL.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MP14_SUBZONE_WEB_PL' from data source 
  `D:\Kabeer2003\GAA Project Group 5\GAA-Project-2024-Group-5-\data\geospatial\MP14_SUBZONE_WEB_PL.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>crs_info1 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(singapore_mpsz)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_info1[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$input
[1] "SVY21"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(singapore_mpsz, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(singapore_mpsz)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>crs_info1 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(singapore_mpsz)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_info1[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$input
[1] "EPSG:4326"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mrt_lines = st_read("D:/Kabeer2003/GAA Project Group #5/GAA-Project-2024-Group-5-/data/geospatial/gis_osm_railways_free_1.shp")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>hawker_centres <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"D:/Kabeer2003/GAA Project Group 5/GAA-Project-2024-Group-5-/data/aspatial/updated_hawker_centres.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>hawker_stalls <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"D:/Kabeer2003/GAA Project Group 5/GAA-Project-2024-Group-5-/data/aspatial/updated_hawker_stalls.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.numeric</span>(hawker_centres<span class="sc">$</span><span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>)) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  hawker_centres<span class="sc">$</span><span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.character</span>(hawker_centres<span class="sc">$</span><span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'Postal Code' column in hawker_stalls to character if it's numeric</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.numeric</span>(hawker_stalls<span class="sc">$</span><span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>)) {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  hawker_stalls<span class="sc">$</span><span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.character</span>(hawker_stalls<span class="sc">$</span><span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(hawker_centres, hawker_stalls, <span class="at">by =</span> <span class="st">"Postal Code"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>hawker_stalls_data_filtered <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>, <span class="st">`</span><span class="at">Hawker Centres</span><span class="st">`</span>, Longitude, Latitude, <span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>filtered_hawker_stalls_data_clean <span class="ot">&lt;-</span> hawker_stalls_data_filtered[<span class="sc">!</span><span class="fu">is.na</span>(hawker_stalls_data_filtered<span class="sc">$</span>Longitude) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(hawker_stalls_data_filtered<span class="sc">$</span>Latitude), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(filtered_hawker_stalls_data_clean, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>crs_info2 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(filtered_hawker_stalls_data_sf)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_info2[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$input
[1] "EPSG:4326"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(filtered_hawker_stalls_data_sf, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>crs_info2 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(filtered_hawker_stalls_data_sf)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_info2[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$input
[1] "EPSG:4326"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> filtered_hawker_stalls_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> filtered_hawker_stalls_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Back to"</span>, <span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>complete_filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> filtered_hawker_stalls_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"#"</span>, <span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>crs_info3 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(complete_filtered_hawker_stalls_data_sf)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_info3[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$input
[1] "EPSG:4326"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>complete_filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(complete_filtered_hawker_stalls_data_sf, <span class="dv">4326</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>crs_info3 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(complete_filtered_hawker_stalls_data_sf)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_info3[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$input
[1] "EPSG:4326"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(singapore_mpsz, <span class="dv">4326</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(singapore_mpsz)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>complete_filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(complete_filtered_hawker_stalls_data_sf, <span class="dv">4326</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>complete_filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(complete_filtered_hawker_stalls_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>hawkers_united <span class="ot">=</span> <span class="fu">st_join</span>(singapore_mpsz, complete_filtered_hawker_stalls_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>hawkers_by_region <span class="ot">&lt;-</span> hawkers_united <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">PLN_AREA_N</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION_N</span><span class="st">`</span>, <span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>, <span class="st">`</span><span class="at">Hawker Centres</span><span class="st">`</span>, <span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>hawkers_all_regions <span class="ot">&lt;-</span> hawkers_by_region <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Postal Code</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(singapore_mpsz) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hawkers_all_regions) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>directory_path <span class="ot">&lt;-</span> <span class="st">"D:/Kabeer2003/GAA Project Group 5/GAA-Project-2024-Group-5-/data"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(directory_path)) {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(directory_path, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(hawkers_all_regions, <span class="fu">file.path</span>(directory_path, <span class="st">"hawkers_all_regions.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"D:/Kabeer2003/GAA Project Group 5/GAA-Project-2024-Group-5-/data/hawkers_all_regions.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(singapore_mpsz, <span class="dv">3414</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>singapore_mpsz <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(singapore_mpsz)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>complete_filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(complete_filtered_hawker_stalls_data_sf, <span class="dv">3414</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>complete_filtered_hawker_stalls_data_sf <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(complete_filtered_hawker_stalls_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hawker_centre_pts <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(complete_filtered_hawker_stalls_data_sf) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>singapore_mpsz1 <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(singapore_mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>hawker_centre_pts_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(hawker_centre_pts, <span class="st">"SpatialPoints"</span>) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>singapore_mpsz_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(singapore_mpsz1, <span class="st">"SpatialPolygons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>singapore_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(singapore_mpsz_sp, <span class="st">"owin"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(singapore_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(singapore_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Window: polygonal boundary
386 separate polygons (20 holes)
                   vertices         area relative.area
polygon 1               156  1.63038e+06      2.09e-03
polygon 2               303  5.59816e+05      7.16e-04
polygon 3                47  1.60809e+05      2.06e-04
polygon 4                47  5.95423e+05      7.61e-04
polygon 5                48  3.87430e+05      4.95e-04
polygon 6                59  1.03038e+06      1.32e-03
polygon 7                83  5.51731e+05      7.06e-04
polygon 8                70  2.90185e+05      3.71e-04
polygon 9               217  1.08479e+06      1.39e-03
polygon 10               42  6.31643e+05      8.08e-04
polygon 11              226  1.82685e+06      2.34e-03
polygon 12               52  2.93711e+05      3.76e-04
polygon 13              256  1.84406e+06      2.36e-03
polygon 14              164  3.92563e+05      5.02e-04
polygon 15              238  5.06591e+05      6.48e-04
polygon 16               22  6.74620e+03      8.63e-06
polygon 17               47  3.82089e+04      4.89e-05
polygon 18               65  8.42861e+04      1.08e-04
polygon 19              469  2.06120e+06      2.64e-03
polygon 20              264  1.50631e+06      1.93e-03
polygon 21             1149  3.30122e+07      4.22e-02
polygon 22 (hole)        23 -1.25692e+03     -1.61e-06
polygon 23                4  9.47128e+01      1.21e-07
polygon 24               37  1.29491e+04      1.66e-05
polygon 25               30  4.28953e+03      5.49e-06
polygon 26              145  9.61783e+05      1.23e-03
polygon 27              227  1.10308e+06      1.41e-03
polygon 28               19  3.09219e+04      3.95e-05
polygon 29               10  6.60201e+03      8.44e-06
polygon 30              234  2.08755e+06      2.67e-03
polygon 31               15  4.03288e+04      5.16e-05
polygon 32             1045  4.44510e+06      5.68e-03
polygon 33 (hole)        13 -3.92141e+02     -5.01e-07
polygon 34              233  4.72887e+05      6.05e-04
polygon 35               14  5.86528e+03      7.50e-06
polygon 36               10  4.90997e+02      6.28e-07
polygon 37               94  5.96175e+04      7.62e-05
polygon 38               59  3.43163e+04      4.39e-05
polygon 39 (hole)         3 -7.68533e-02     -9.83e-11
polygon 40                4  2.69408e+02      3.45e-07
polygon 41             1026  1.27782e+06      1.63e-03
polygon 42              132  9.53360e+04      1.22e-04
polygon 43                6  4.50376e+02      5.76e-07
polygon 44              155  2.67503e+05      3.42e-04
polygon 45              211  4.70522e+05      6.02e-04
polygon 46              106  3.04131e+03      3.89e-06
polygon 47               83  5.28926e+03      6.76e-06
polygon 48             1462  4.87083e+06      6.23e-03
polygon 49 (hole)        11 -8.36614e+01     -1.07e-07
polygon 50               75  1.73525e+04      2.22e-05
polygon 51              147  3.10396e+03      3.97e-06
polygon 52              138  3.22285e+03      4.12e-06
polygon 53               45  2.51228e+03      3.21e-06
polygon 54               40  1.38603e+04      1.77e-05
polygon 55              426  3.44964e+06      4.41e-03
polygon 56               83  1.03237e+05      1.32e-04
polygon 57              104  1.12730e+06      1.44e-03
polygon 58              759  2.70301e+06      3.46e-03
polygon 59 (hole)        28 -1.99840e+01     -2.56e-08
polygon 60 (hole)        48 -1.38327e+02     -1.77e-07
polygon 61 (hole)        20 -4.37607e+00     -5.60e-09
polygon 62 (hole)       351 -1.21346e+03     -1.55e-06
polygon 63               53  2.76828e+05      3.54e-04
polygon 64              114  6.36655e+04      8.14e-05
polygon 65               83  1.96620e+05      2.51e-04
polygon 66               33  3.65334e+05      4.67e-04
polygon 67              106  1.45483e+06      1.86e-03
polygon 68              133  8.53203e+05      1.09e-03
polygon 69              196  1.07072e+06      1.37e-03
polygon 70               47  5.33016e+05      6.82e-04
polygon 71               82  4.42501e+05      5.66e-04
polygon 72              221  9.31409e+04      1.19e-04
polygon 73               37  4.11723e+05      5.27e-04
polygon 74              227  5.87221e+05      7.51e-04
polygon 75               35  3.94370e+04      5.04e-05
polygon 76               96  1.88768e+05      2.41e-04
polygon 77               59  1.33007e+05      1.70e-04
polygon 78               46  4.48128e+05      5.73e-04
polygon 79               31  5.21199e+05      6.67e-04
polygon 80               17  3.50788e+05      4.49e-04
polygon 81               54  2.61841e+05      3.35e-04
polygon 82              239  1.59034e+06      2.03e-03
polygon 83              298  8.86957e+05      1.13e-03
polygon 84              190  2.23207e+05      2.85e-04
polygon 85              142  2.00053e+05      2.56e-04
polygon 86              169  7.10568e+05      9.09e-04
polygon 87               34  7.48683e+05      9.57e-04
polygon 88              192  5.91779e+05      7.57e-04
polygon 89              177  1.75595e+06      2.25e-03
polygon 90              192  3.40742e+05      4.36e-04
polygon 91              217  3.29438e+05      4.21e-04
polygon 92               87  1.70664e+05      2.18e-04
polygon 93              173  3.68483e+05      4.71e-04
polygon 94              289  7.60191e+06      9.72e-03
polygon 95              242  2.21974e+05      2.84e-04
polygon 96              130  2.80176e+05      3.58e-04
polygon 97              140  2.14251e+05      2.74e-04
polygon 98               83  1.73123e+05      2.21e-04
polygon 99               92  5.33671e+05      6.82e-04
polygon 100              95  1.45518e+05      1.86e-04
polygon 101              55  6.35706e+05      8.13e-04
polygon 102              54  5.03226e+05      6.44e-04
polygon 103              48  5.56817e+04      7.12e-05
polygon 104              60  1.16331e+05      1.49e-04
polygon 105             137  2.05165e+06      2.62e-03
polygon 106             122  2.43459e+06      3.11e-03
polygon 107             113  1.71362e+06      2.19e-03
polygon 108              55  3.10515e+05      3.97e-04
polygon 109              95  1.38665e+06      1.77e-03
polygon 110             127  1.95186e+06      2.50e-03
polygon 111             266  4.52473e+05      5.79e-04
polygon 112              79  6.97507e+05      8.92e-04
polygon 113              71  5.63055e+03      7.20e-06
polygon 114              10  1.99759e+02      2.55e-07
polygon 115             435  2.77052e+07      3.54e-02
polygon 116               3  1.96470e-01      2.51e-10
polygon 117             117  1.71719e+05      2.20e-04
polygon 118             271  1.09784e+06      1.40e-03
polygon 119             135  1.05350e+06      1.35e-03
polygon 120             305  2.79600e+06      3.58e-03
polygon 121             554  3.04972e+06      3.90e-03
polygon 122 (hole)        3 -7.06427e-01     -9.03e-10
polygon 123             137  3.36218e+05      4.30e-04
polygon 124              62  7.41438e+05      9.48e-04
polygon 125             319  4.60551e+05      5.89e-04
polygon 126             198  5.43484e+05      6.95e-04
polygon 127              52  2.78303e+05      3.56e-04
polygon 128             539  1.76950e+06      2.26e-03
polygon 129             149  3.85093e+05      4.92e-04
polygon 130             120  5.58761e+05      7.15e-04
polygon 131              88  5.67581e+06      7.26e-03
polygon 132             212  2.09608e+06      2.68e-03
polygon 133              88  7.22591e+05      9.24e-04
polygon 134             277  2.55046e+06      3.26e-03
polygon 135              34  2.04263e+06      2.61e-03
polygon 136              70  3.26041e+06      4.17e-03
polygon 137             214  1.34615e+06      1.72e-03
polygon 138              25  1.71337e+05      2.19e-04
polygon 139              84  4.96255e+04      6.35e-05
polygon 140             198  1.93991e+05      2.48e-04
polygon 141              77  1.20171e+05      1.54e-04
polygon 142             272  8.50853e+05      1.09e-03
polygon 143              99  1.02647e+06      1.31e-03
polygon 144             154  1.67538e+05      2.14e-04
polygon 145              81  1.16002e+06      1.48e-03
polygon 146              32  2.56100e+06      3.28e-03
polygon 147             112  7.35502e+05      9.41e-04
polygon 148             124  9.48159e+05      1.21e-03
polygon 149             134  1.32109e+06      1.69e-03
polygon 150              59  2.99730e+06      3.83e-03
polygon 151             122  1.37683e+06      1.76e-03
polygon 152             129  1.92662e+06      2.46e-03
polygon 153             513  3.20330e+06      4.10e-03
polygon 154 (hole)        3 -2.51044e-02     -3.21e-11
polygon 155              92  2.34937e+06      3.00e-03
polygon 156              85  9.63202e+05      1.23e-03
polygon 157              35  4.85023e+05      6.20e-04
polygon 158              82  1.88130e+06      2.41e-03
polygon 159             103  1.42508e+06      1.82e-03
polygon 160              60  2.38727e+06      3.05e-03
polygon 161             114  1.07899e+06      1.38e-03
polygon 162              71  4.59544e+05      5.88e-04
polygon 163              90  2.47889e+05      3.17e-04
polygon 164             106  2.13582e+05      2.73e-04
polygon 165             205  2.47265e+06      3.16e-03
polygon 166 (hole)        3 -4.87319e-02     -6.23e-11
polygon 167 (hole)        3 -3.81487e-03     -4.88e-12
polygon 168 (hole)       36 -7.79901e+03     -9.97e-06
polygon 169               4  1.46442e-02      1.87e-11
polygon 170             573  1.94069e+06      2.48e-03
polygon 171 (hole)        4 -2.14740e-02     -2.75e-11
polygon 172             348  2.11850e+06      2.71e-03
polygon 173             109  4.85049e+05      6.20e-04
polygon 174             102  7.57905e+05      9.69e-04
polygon 175             119  3.51243e+05      4.49e-04
polygon 176              69  1.31292e+06      1.68e-03
polygon 177 (hole)        3 -3.72872e-02     -4.77e-11
polygon 178              63  9.46648e+05      1.21e-03
polygon 179             100  7.48039e+05      9.57e-04
polygon 180             110  1.02229e+06      1.31e-03
polygon 181              95  4.10995e+05      5.26e-04
polygon 182              73  8.39489e+05      1.07e-03
polygon 183             173  1.22849e+06      1.57e-03
polygon 184              43  5.54625e+05      7.09e-04
polygon 185             130  3.39290e+06      4.34e-03
polygon 186              97  1.87809e+06      2.40e-03
polygon 187              40  8.67749e+05      1.11e-03
polygon 188              55  6.39144e+05      8.17e-04
polygon 189              39  3.26015e+06      4.17e-03
polygon 190              54  4.11402e+05      5.26e-04
polygon 191              75  4.18656e+05      5.35e-04
polygon 192             104  2.09818e+06      2.68e-03
polygon 193              91  1.52455e+06      1.95e-03
polygon 194              79  8.13382e+05      1.04e-03
polygon 195              94  1.48429e+06      1.90e-03
polygon 196             118  3.10803e+06      3.97e-03
polygon 197              97  1.03728e+06      1.33e-03
polygon 198             157  2.82017e+06      3.61e-03
polygon 199              53  9.24760e+05      1.18e-03
polygon 200             118  1.80655e+06      2.31e-03
polygon 201              64  1.40454e+06      1.80e-03
polygon 202              91  2.37934e+06      3.04e-03
polygon 203             111  2.07780e+06      2.66e-03
polygon 204             134  3.14295e+06      4.02e-03
polygon 205             195  2.63648e+06      3.37e-03
polygon 206              80  1.05717e+06      1.35e-03
polygon 207              56  1.28795e+06      1.65e-03
polygon 208              69  4.39648e+05      5.62e-04
polygon 209              50  7.46884e+05      9.55e-04
polygon 210              61  4.46241e+05      5.71e-04
polygon 211              72  5.72500e+05      7.32e-04
polygon 212             152  2.95937e+06      3.78e-03
polygon 213             119  2.15829e+06      2.76e-03
polygon 214             140  1.34746e+06      1.72e-03
polygon 215              60  2.33891e+06      2.99e-03
polygon 216             111  4.29714e+06      5.50e-03
polygon 217             105  9.91041e+05      1.27e-03
polygon 218             202  2.04955e+06      2.62e-03
polygon 219             126  2.57909e+06      3.30e-03
polygon 220              91  3.18758e+06      4.08e-03
polygon 221              40  9.06316e+05      1.16e-03
polygon 222              41  3.80204e+05      4.86e-04
polygon 223              92  5.26383e+05      6.73e-04
polygon 224              77  8.00299e+05      1.02e-03
polygon 225             124  8.98563e+05      1.15e-03
polygon 226             172  1.79346e+06      2.29e-03
polygon 227             371  3.18810e+06      4.08e-03
polygon 228              85  4.94502e+05      6.32e-04
polygon 229              79  1.06189e+06      1.36e-03
polygon 230              74  1.79446e+06      2.29e-03
polygon 231              96  3.47521e+06      4.44e-03
polygon 232              74  1.22567e+06      1.57e-03
polygon 233             139  1.97438e+06      2.52e-03
polygon 234             159  1.08508e+06      1.39e-03
polygon 235              90  1.96414e+06      2.51e-03
polygon 236              43  1.97494e+06      2.53e-03
polygon 237             141  4.14132e+06      5.30e-03
polygon 238             164  4.33983e+06      5.55e-03
polygon 239             131  1.79606e+06      2.30e-03
polygon 240             130  2.25115e+06      2.88e-03
polygon 241             124  7.76141e+05      9.93e-04
polygon 242             105  2.20631e+06      2.82e-03
polygon 243             106  1.18013e+06      1.51e-03
polygon 244              73  1.22990e+06      1.57e-03
polygon 245             101  9.64681e+05      1.23e-03
polygon 246              75  1.26341e+06      1.62e-03
polygon 247              50  3.69771e+05      4.73e-04
polygon 248              83  3.20366e+06      4.10e-03
polygon 249              96  1.10727e+06      1.42e-03
polygon 250              81  1.28739e+06      1.65e-03
polygon 251              32  8.42672e+05      1.08e-03
polygon 252              61  1.33353e+06      1.71e-03
polygon 253              50  1.00740e+06      1.29e-03
polygon 254             147  8.94517e+05      1.14e-03
polygon 255              76  9.11208e+05      1.17e-03
polygon 256              43  1.14382e+06      1.46e-03
polygon 257              95  1.32887e+06      1.70e-03
polygon 258             111  6.09896e+05      7.80e-04
polygon 259              66  7.63181e+05      9.76e-04
polygon 260             164  2.76835e+06      3.54e-03
polygon 261             134  3.46704e+06      4.43e-03
polygon 262             401  7.83399e+06      1.00e-02
polygon 263              80  2.77864e+06      3.55e-03
polygon 264              54  8.62737e+05      1.10e-03
polygon 265             105  1.58344e+06      2.03e-03
polygon 266              43  8.46135e+05      1.08e-03
polygon 267             122  1.74439e+06      2.23e-03
polygon 268              89  1.00159e+06      1.28e-03
polygon 269              82  1.09730e+06      1.40e-03
polygon 270             251  4.84852e+06      6.20e-03
polygon 271              53  6.68456e+05      8.55e-04
polygon 272              69  6.24879e+05      7.99e-04
polygon 273              85  6.74995e+05      8.63e-04
polygon 274             123  2.33068e+06      2.98e-03
polygon 275              68  1.09322e+06      1.40e-03
polygon 276              83  1.86187e+06      2.38e-03
polygon 277              45  9.09420e+05      1.16e-03
polygon 278             107  2.11479e+06      2.70e-03
polygon 279             204  3.33419e+06      4.26e-03
polygon 280              59  1.51553e+06      1.94e-03
polygon 281              60  9.44998e+05      1.21e-03
polygon 282             189  1.99078e+06      2.55e-03
polygon 283              91  1.49663e+04      1.91e-05
polygon 284              71  8.18741e+03      1.05e-05
polygon 285              83  1.64142e+06      2.10e-03
polygon 286             173  1.65258e+05      2.11e-04
polygon 287              83  2.25924e+06      2.89e-03
polygon 288             221  3.86033e+06      4.94e-03
polygon 289              58  8.59179e+05      1.10e-03
polygon 290              63  5.46403e+05      6.99e-04
polygon 291              71  1.94861e+06      2.49e-03
polygon 292              87  1.07862e+06      1.38e-03
polygon 293              99  6.87931e+05      8.80e-04
polygon 294             151  3.02315e+06      3.87e-03
polygon 295              35  4.41738e+05      5.65e-04
polygon 296              62  9.70064e+05      1.24e-03
polygon 297              93  1.23590e+06      1.58e-03
polygon 298             100  1.63967e+06      2.10e-03
polygon 299             106  2.54311e+06      3.25e-03
polygon 300              83  9.55710e+05      1.22e-03
polygon 301              58  3.16883e+05      4.05e-04
polygon 302              94  1.04642e+06      1.34e-03
polygon 303              63  9.21433e+05      1.18e-03
polygon 304             149  7.37056e+06      9.43e-03
polygon 305              52  6.84703e+05      8.76e-04
polygon 306             126  1.51148e+06      1.93e-03
polygon 307             151  2.45910e+06      3.14e-03
polygon 308             191  7.03480e+06      9.00e-03
polygon 309             158  3.65203e+06      4.67e-03
polygon 310             285  1.71971e+06      2.20e-03
polygon 311 (hole)        3 -2.86414e-01     -3.66e-10
polygon 312              84  1.08864e+06      1.39e-03
polygon 313              81  1.56904e+06      2.01e-03
polygon 314             174  1.67003e+06      2.14e-03
polygon 315              79  2.39108e+06      3.06e-03
polygon 316              52  1.37871e+06      1.76e-03
polygon 317             100  9.23214e+05      1.18e-03
polygon 318             246  5.32542e+06      6.81e-03
polygon 319              92  1.41829e+06      1.81e-03
polygon 320              50  1.48925e+06      1.90e-03
polygon 321             117  5.18612e+06      6.63e-03
polygon 322             532  3.50960e+07      4.49e-02
polygon 323              80  1.46328e+06      1.87e-03
polygon 324             258  9.95947e+05      1.27e-03
polygon 325              55  1.45551e+06      1.86e-03
polygon 326              44  1.49911e+06      1.92e-03
polygon 327              68  9.24865e+05      1.18e-03
polygon 328             127  1.34017e+06      1.71e-03
polygon 329             348  8.50444e+06      1.09e-02
polygon 330 (hole)      316 -5.11288e+04     -6.54e-05
polygon 331             208  1.36000e+06      1.74e-03
polygon 332              67  1.43137e+05      1.83e-04
polygon 333              64  4.36369e+05      5.58e-04
polygon 334               3  6.54649e-01      8.37e-10
polygon 335             130  1.25974e+06      1.61e-03
polygon 336             112  3.29141e+06      4.21e-03
polygon 337             102  1.57600e+06      2.02e-03
polygon 338             122  1.66547e+06      2.13e-03
polygon 339              94  1.76709e+06      2.26e-03
polygon 340            1831  6.97053e+07      8.91e-02
polygon 341              30  2.80002e+04      3.58e-05
polygon 342              27  1.50311e+04      1.92e-05
polygon 343              95  2.05005e+06      2.62e-03
polygon 344             129  1.51776e+06      1.94e-03
polygon 345             117  5.95652e+05      7.62e-04
polygon 346             263  3.28413e+06      4.20e-03
polygon 347             118  2.55346e+06      3.27e-03
polygon 348              49  9.62437e+05      1.23e-03
polygon 349             112  1.28130e+06      1.64e-03
polygon 350              26  7.58119e+05      9.70e-04
polygon 351              76  9.05921e+05      1.16e-03
polygon 352             285  1.61128e+06      2.06e-03
polygon 353              65  1.26165e+06      1.61e-03
polygon 354            1596  1.74949e+07      2.24e-02
polygon 355 (hole)        3 -1.23053e-04     -1.57e-13
polygon 356             164  3.45046e+06      4.41e-03
polygon 357              65  1.74196e+06      2.23e-03
polygon 358              74  1.39487e+06      1.78e-03
polygon 359             141  1.07438e+06      1.37e-03
polygon 360             668  5.40368e+07      6.91e-02
polygon 361              77  3.29940e+05      4.22e-04
polygon 362             708  1.28815e+07      1.65e-02
polygon 363              44  2.26583e+03      2.90e-06
polygon 364             181  7.23582e+06      9.25e-03
polygon 365             192  2.14709e+06      2.75e-03
polygon 366              90  1.51100e+06      1.93e-03
polygon 367             125  9.36415e+05      1.20e-03
polygon 368             148  1.64863e+06      2.11e-03
polygon 369             102  1.09939e+06      1.41e-03
polygon 370              77  2.20921e+06      2.83e-03
polygon 371              79  1.26438e+06      1.62e-03
polygon 372              75  2.20669e+06      2.82e-03
polygon 373              40  1.26592e+06      1.62e-03
polygon 374             720  3.71479e+07      4.75e-02
polygon 375             111  3.91607e+06      5.01e-03
polygon 376             148  2.17538e+06      2.78e-03
polygon 377             131  3.62184e+06      4.63e-03
polygon 378              80  1.43291e+06      1.83e-03
polygon 379             112  4.38713e+06      5.61e-03
polygon 380             145  1.20081e+06      1.54e-03
polygon 381             531  2.45079e+06      3.13e-03
polygon 382 (hole)        3 -1.78426e-03     -2.28e-12
polygon 383 (hole)        3 -2.25260e+00     -2.88e-09
polygon 384             125  1.54074e+06      1.97e-03
polygon 385             378  1.63581e+06      2.09e-03
polygon 386             357  2.24138e+06      2.87e-03
enclosing rectangle: [2667.54, 56396.44] x [15748.72, 50256.33] units
                     (53730 x 34510 units)
Window area = 781945000 square units
Fraction of frame area: 0.422</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>hawker_centres_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(hawker_centre_pts_sp, <span class="st">"ppp"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hawker_centres_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hawker_centres_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  5818 points
Average intensity 8.539384e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [12287.77, 45225.29] x [27687.23, 48372.26] units
                    (32940 x 20690 units)
Window area = 681314000 square units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>hawkers_SG_ppp <span class="ot">=</span> hawker_centres_ppp[singapore_owin]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hawkers_SG_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>hawkers_SG_ppp <span class="ot">&lt;-</span> <span class="fu">rescale</span>(hawkers_SG_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>kde_hawkers_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(hawkers_SG_ppp, <span class="at">sigma=</span><span class="fl">0.8</span>, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_hawkers_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bw.CvL</span>(hawkers_SG_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sigma 
6.177942 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bw.scott</span>(hawkers_SG_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> sigma.x  sigma.y 
1.496867 1.021742 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bw.ppl</span>(hawkers_SG_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sigma 
0.09078989 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bw.diggle</span>(hawkers_SG_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sigma 
0.006399932 </code></pre>
</div>
</div>
<p>Filter by food option and planning area</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="ot">&lt;-</span> hawkers_all_regions[</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">"roast"</span>, hawkers_all_regions<span class="sc">$</span><span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  hawkers_all_regions<span class="sc">$</span>REGION_N <span class="sc">==</span> <span class="st">"CENTRAL REGION"</span>, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>sg_central_region <span class="ot">&lt;-</span> singapore_mpsz <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(REGION_N <span class="sc">==</span> <span class="st">"CENTRAL REGION"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>central_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(sg_central_region)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>central_sp <span class="ot">=</span> <span class="fu">as</span>(central_sp, <span class="st">"SpatialPolygons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>central_owin <span class="ot">=</span> <span class="fu">as</span>(central_sp, <span class="st">"owin"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(central_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>bukit_merah <span class="ot">&lt;-</span> singapore_mpsz <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PLN_AREA_N <span class="sc">==</span> <span class="st">"BUKIT MERAH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>BM_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(bukit_merah)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>BM_sp <span class="ot">=</span> <span class="fu">as</span>(BM_sp, <span class="st">"SpatialPolygons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>BM_owin <span class="ot">=</span> <span class="fu">as</span>(BM_sp, <span class="st">"owin"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BM_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>roasted_meat <span class="ot">&lt;-</span> complete_filtered_hawker_stalls_data_sf[</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">"roast"</span>, complete_filtered_hawker_stalls_data_sf<span class="sc">$</span><span class="st">`</span><span class="at">Hawker Centre Stalls</span><span class="st">`</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>), </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>roasted_meat_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(roasted_meat)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>roasted_meat_sp <span class="ot">=</span> <span class="fu">as</span>(roasted_meat_sp, <span class="st">"SpatialPoints"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>roasted_meat_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(roasted_meat_sp, <span class="st">"ppp"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roasted_meat_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>roasted_meat_central_ppp <span class="ot">=</span> roasted_meat_ppp[central_owin]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roasted_meat_central_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>roasted_meat_BM_ppp <span class="ot">=</span> roasted_meat_ppp[BM_owin]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roasted_meat_BM_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>G_C <span class="ot">=</span> <span class="fu">Gest</span>(roasted_meat_central_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_C, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>F_C <span class="ot">=</span> <span class="fu">Fest</span>(roasted_meat_central_ppp)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(F_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>F_C.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(roasted_meat_central_ppp, Fest, <span class="at">nsim =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 500 simulations of CSR  ...
1, 2, 3, .5....10....15....20....25....30....35....40....45....50..
..55....60....65....70....75....80....85....90....95....100....105....110
....115....120....125....130....135....140....145....150....155....160....165...
.170....175....180....185....190....195....200....205....210....215....220....225.
...230....235....240....245....250....255....260....265....270....275....280....
285....290....295....300....305....310....315....320....325....330....335....340..
..345....350....355....360....365....370....375....380....385....390....395....400
....405....410....415....420....425....430....435....440....445....450....455...
.460....465....470....475....480....485....490....495....
500.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(F_C.csr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>K_c <span class="ot">=</span> <span class="fu">Kest</span>(roasted_meat_central_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_c, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"K(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>L_c <span class="ot">=</span> <span class="fu">Lest</span>(roasted_meat_central_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_c, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="test_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Inputs: Filter by region: Central, East, West, North, Northeast Filter by planning area: Downtown Core, Rochor, Bukit Merah, Geylang Filter by food: Lor Mee, Roasted Meat, Ban Mian, Chicken Rice Filter by Dietary Restrictions</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>